<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paperbird</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .tab-active {
            border-bottom-color: #f59e0b; /* amber-500 */
            color: #0f172a; /* slate-900 */
            font-weight: 600;
        }
        .tab-inactive {
            border-bottom-color: transparent;
            color: #64748b; /* slate-500 */
        }
        .card-read {
            opacity: 0.6;
        }
        .card-not-interested {
            display: none;
        }
        .icon-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 9999px;
            transition: background-color 0.2s;
        }
        .icon-btn.collect-btn.collected {
            color: #f59e0b; /* amber-500 */
            background-color: #fffbeb; /* amber-100 */
        }
    </style>
</head>
<body class="text-slate-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">

        <header class="flex items-center justify-between mb-8">
            <h1 class="text-3xl font-bold text-slate-900">
                <i class="fa-solid fa-feather-pointed text-amber-500"></i>
                Paperbird
            </h1>
            <div class="border-b border-slate-200">
                <nav class="-mb-px flex space-x-6" aria-label="Tabs">
                    <button id="tab-discover" class="whitespace-nowrap py-3 px-1 border-b-2 text-sm tab-active">Discover</button>
                    <button id="tab-collection" class="whitespace-nowrap py-3 px-1 border-b-2 text-sm tab-inactive">Collection</button>
                </nav>
            </div>
        </header>

        <main id="main-content">
            <!-- Content will be injected here by JavaScript -->
        </main>

    </div>

    <!-- Discover Page Template -->
    <template id="discover-page-template">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <aside class="lg:col-span-1">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 sticky top-8">
                    <h2 class="text-xl font-bold mb-2 text-slate-900">Relevance Prompt</h2>
                    <p class="text-slate-600 mb-4 text-sm">Define your interests to get tailored paper recommendations.</p>
                    <textarea id="relevance-prompt" class="w-full h-48 p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition" placeholder="I'm a PM for recommendation systems. I'm interested in new embedding techniques, multi-modal recommendations, and papers on fairness in ranking from Google, Meta, and Netflix."></textarea>
                    <button id="save-prompt-btn" class="mt-4 w-full bg-amber-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-amber-600 transition-colors shadow-sm">Save Prompt</button>
                </div>
            </aside>
            <section class="lg:col-span-2">
                <div id="paper-feed" class="space-y-5">
                    <!-- Paper cards will be injected here -->
                </div>
            </section>
        </div>
    </template>

    <!-- Collection Page Template -->
    <template id="collection-page-template">
        <div>
            <h2 class="text-2xl font-bold mb-1 text-slate-900">Collected Papers</h2>
            <p class="text-slate-600 mb-6 text-sm">Your curated list of important papers. Add notes to synthesize your thoughts.</p>
            <div id="collection-feed" class="space-y-5">
                <!-- Collected paper cards will be injected here -->
            </div>
        </div>
    </template>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mainContent = document.getElementById('main-content');
            const discoverTab = document.getElementById('tab-discover');
            const collectionTab = document.getElementById('tab-collection');
            const discoverPageTemplate = document.getElementById('discover-page-template');
            const collectionPageTemplate = document.getElementById('collection-page-template');

            let papers = [
                { id: 1, title: "Scaling DeepMind's Gato: A Generalist Agent", authors: "Scott Reed et al.", org: "DeepMind", date: "2024-07-15", summary: "This paper introduces Gato, a single generalist agent capable of a wide range of tasks. It's relevant for its novel approach to multi-task learning, suggesting a path toward more versatile and efficient recommendation models.", link: "#", status: "new", collected: false, notes: null },
                { id: 2, title: "Self-Rewarding Language Models", authors: "Yuan-Sen Ting et al.", org: "Google", date: "2024-07-22", summary: "Explores a new paradigm where LLMs can self-improve by generating their own rewards. This is highly relevant for building adaptive recommendation systems that can refine their own logic without constant human supervision.", link: "#", status: "new", collected: false, notes: null },
                { id: 3, title: "Fairness in Two-Sided Marketplaces: A Case Study", authors: "Sarah Dean et al.", org: "Netflix", date: "2024-07-18", summary: "A critical analysis of fairness constraints in recommendation systems for marketplaces. It provides a framework for balancing user satisfaction with provider fairness, a key challenge for PMs in this space.", link: "#", status: "new", collected: true, notes: "This is a key paper for our Q4 planning. The framework on page 5 is particularly relevant to the new supplier fairness initiative." },
                { id: 4, title: "Multi-Modal Embeddings for Fashion Recommendation", authors: "Li Jing et al.", org: "Meta AI", date: "2024-07-25", summary: "Details a system that combines image and text data to create richer user profiles and item embeddings. The techniques for fusing modalities are directly applicable to improving catalog-based recommendations.", link: "#", status: "new", collected: false, notes: null },
            ];

            function createPaperCard(paper, pageType) {
                const card = document.createElement('div');
                card.className = `bg-white p-5 rounded-xl shadow-sm border border-slate-200 transition-all duration-300 paper-card`;
                card.dataset.id = paper.id;

                if (paper.status === 'read') {
                    card.classList.add('card-read');
                }

                let contentHtml;
                if (pageType === 'collection') {
                    const currentNote = paper.notes || paper.summary;
                    contentHtml = `
                        <div class="mt-4" data-note-container>
                            <div class="flex justify-between items-center mb-2">
                                <h5 class="font-semibold text-sm text-slate-700">Summary & Notes</h5>
                                <button data-action="edit-note" class="icon-btn hover:bg-slate-200" title="Edit Notes">
                                    <i class="fa-solid fa-pencil"></i>
                                </button>
                            </div>
                            <p class="text-slate-700">${currentNote}</p>
                        </div>
                    `;
                } else {
                    contentHtml = `<p class="text-slate-700 my-4">${paper.summary}</p>`;
                }

                const discoverButtons = `
                    <button data-action="collect" class="icon-btn collect-btn ${paper.collected ? 'collected' : ''}" title="Collect">
                        <i class="fa-solid fa-star"></i>
                    </button>
                    <button data-action="read" class="icon-btn hover:bg-slate-200" title="Mark as Read">
                        <i class="fa-solid fa-check"></i>
                    </button>
                    <button data-action="not_interested" class="icon-btn hover:bg-slate-200" title="Not Interested">
                        <i class="fa-solid fa-circle-xmark"></i>
                    </button>
                `;

                card.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-sm text-slate-500 mb-1">${paper.date} &bull; ${paper.org}</p>
                            <h3 class="font-bold text-lg text-slate-800">${paper.title}</h3>
                            <p class="text-sm text-slate-600 font-medium">${paper.authors}</p>
                        </div>
                        ${pageType === 'discover' ? `<div class="flex items-center space-x-1 flex-shrink-0 ml-4">${discoverButtons}</div>` : ''}
                    </div>
                    ${contentHtml}
                    <a href="${paper.link}" target="_blank" class="inline-block mt-4 text-amber-600 hover:text-amber-700 font-semibold text-sm">
                        Read on arXiv <i class="fa-solid fa-arrow-right text-xs"></i>
                    </a>
                `;
                return card;
            }

            function renderDiscoverPage() {
                const pageNode = discoverPageTemplate.content.cloneNode(true);
                const feed = pageNode.getElementById('paper-feed');
                feed.innerHTML = '';
                papers.forEach(paper => {
                    if (paper.status !== 'not_interested') {
                        const card = createPaperCard(paper, 'discover');
                        feed.appendChild(card);
                    }
                });
                mainContent.innerHTML = '';
                mainContent.appendChild(pageNode);
            }

            function renderCollectionPage() {
                const pageNode = collectionPageTemplate.content.cloneNode(true);
                const feed = pageNode.getElementById('collection-feed');
                feed.innerHTML = '';
                const collectedPapers = papers.filter(p => p.collected);
                if (collectedPapers.length > 0) {
                    collectedPapers.forEach(paper => {
                        const card = createPaperCard(paper, 'collection');
                        feed.appendChild(card);
                    });
                } else {
                    feed.innerHTML = `<p class="text-center text-slate-500 py-8">You haven't collected any papers yet. Click the star icon on the Discover page to save papers here.</p>`;
                }
                mainContent.innerHTML = '';
                mainContent.appendChild(pageNode);
            }

            function handleTabClick(activeTab, inactiveTab, renderFunction) {
                activeTab.classList.add('tab-active');
                activeTab.classList.remove('tab-inactive');
                inactiveTab.classList.add('tab-inactive');
                inactiveTab.classList.remove('tab-active');
                renderFunction();
            }

            discoverTab.addEventListener('click', () => handleTabClick(discoverTab, collectionTab, renderDiscoverPage));
            collectionTab.addEventListener('click', () => handleTabClick(collectionTab, discoverTab, renderCollectionPage));

            mainContent.addEventListener('click', (e) => {
                const button = e.target.closest('button[data-action]');
                if (!button) return;

                const action = button.dataset.action;
                const card = button.closest('.paper-card');
                const paperId = parseInt(card.dataset.id);
                const paper = papers.find(p => p.id === paperId);

                if (paper) {
                    switch(action) {
                        case 'collect':
                            paper.collected = !paper.collected;
                            button.classList.toggle('collected');
                            break;
                        case 'read':
                            paper.status = 'read';
                            card.classList.add('card-read');
                            break;
                        case 'not_interested':
                            paper.status = 'not_interested';
                            card.classList.add('card-not-interested');
                            break;
                        case 'edit-note': {
                            const noteContainer = card.querySelector('[data-note-container]');
                            const p = noteContainer.querySelector('p');
                            const currentText = p.textContent;
                            noteContainer.innerHTML = `
                                <div class="flex justify-between items-center mb-2">
                                    <h5 class="font-semibold text-sm text-slate-700">Summary & Notes</h5>
                                    <button data-action="save-note" class="icon-btn hover:bg-green-100 text-green-600" title="Save Notes">
                                        <i class="fa-solid fa-check"></i>
                                    </button>
                                </div>
                                <textarea class="w-full h-32 p-2 border border-slate-300 rounded-md text-sm focus:ring-2 focus:ring-amber-500 focus:border-amber-500">${currentText}</textarea>
                            `;
                            noteContainer.querySelector('textarea').focus();
                            break;
                        }
                        case 'save-note': {
                            const noteContainer = card.querySelector('[data-note-container]');
                            const textarea = noteContainer.querySelector('textarea');
                            const newText = textarea.value;
                            paper.notes = newText;
                            noteContainer.innerHTML = `
                                <div class="flex justify-between items-center mb-2">
                                    <h5 class="font-semibold text-sm text-slate-700">Summary & Notes</h5>
                                    <button data-action="edit-note" class="icon-btn hover:bg-slate-200" title="Edit Notes">
                                        <i class="fa-solid fa-pencil"></i>
                                    </button>
                                </div>
                                <p class="text-slate-700">${newText}</p>
                            `;
                            break;
                        }
                    }
                }
            });

            // Initial load
            renderDiscoverPage();
        });
    </script>
</body>
</html>
